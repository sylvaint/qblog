[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Blog about AI, machine learning and data analysis."
  },
  {
    "objectID": "posts/spikeet/index.html",
    "href": "posts/spikeet/index.html",
    "title": "Spikeet data validation",
    "section": "",
    "text": "This notebook attempts to validate Spikeet quote data for SP500 stocks with Yahoo and Cloudquant data.\nUsing these data sources, we derive the top 20 daily stock by return close to close daily and intraday, and the bottom 20 by return close to close daily and intraday. We do this for the last 3 years.\nWe compare the Yahoo results and the Cloudquant results and find them to be identical except for 2 instances with WBD and EXC. Yahoo is correct in both those cases.\nWe then compare Yahoo results with the Spikeet data from 4 different screens as we could not figure out how to do OR logic and needed to run 4 separate screens on Spikeet.\nWe found many discrepancies between Yahoo results and Spikeet.\nAlmost all Spikeet data was wrong in each of those cases except in one instance.\nFor the 20 bottom intraday returns from the SP500 in the last 3 years, Spikeet comes up with a list that is more than 30% wrong."
  },
  {
    "objectID": "posts/spikeet/index.html#overview",
    "href": "posts/spikeet/index.html#overview",
    "title": "Spikeet data validation",
    "section": "",
    "text": "This notebook attempts to validate Spikeet quote data for SP500 stocks with Yahoo and Cloudquant data.\nUsing these data sources, we derive the top 20 daily stock by return close to close daily and intraday, and the bottom 20 by return close to close daily and intraday. We do this for the last 3 years.\nWe compare the Yahoo results and the Cloudquant results and find them to be identical except for 2 instances with WBD and EXC. Yahoo is correct in both those cases.\nWe then compare Yahoo results with the Spikeet data from 4 different screens as we could not figure out how to do OR logic and needed to run 4 separate screens on Spikeet.\nWe found many discrepancies between Yahoo results and Spikeet.\nAlmost all Spikeet data was wrong in each of those cases except in one instance.\nFor the 20 bottom intraday returns from the SP500 in the last 3 years, Spikeet comes up with a list that is more than 30% wrong."
  },
  {
    "objectID": "posts/spikeet/index.html#code",
    "href": "posts/spikeet/index.html#code",
    "title": "Spikeet data validation",
    "section": "Code",
    "text": "Code\n\nimport yfinance as yf\nimport pandas as pd\nimport os\nimport warnings\nimport liberator\n\n\n# function to get sp500 tickers from scraping wikipedia\ndef get_sp500_tickers():\n    url = 'https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'\n    table = pd.read_html(url, header=0)[0]\n    tickers = table['Symbol'].tolist()\n    return tickers\n\nsp500_tickers = get_sp500_tickers()"
  },
  {
    "objectID": "posts/spikeet/index.html#yahoo-finance-data",
    "href": "posts/spikeet/index.html#yahoo-finance-data",
    "title": "Spikeet data validation",
    "section": "Yahoo finance data",
    "text": "Yahoo finance data\n\n# function get daily quotes from Yahoo for a list of tickers\ndef get_quotes(tickers):\n    if os.path.exists('sp500_daily.csv'):\n        data = pd.read_csv('sp500_daily.csv', index_col=[0], header=[0,1])\n        return data\n    \n    # Fetch data for the last 3 years\n    # end_date = pd.Timestamp.now()\n    end_date = pd.Timestamp('2023-09-21')\n    # start_date = end_date - pd.DateOffset(years=3)\n    start_date = pd.Timestamp('2020-09-21')\n\n    data = yf.download(tickers, start=start_date, end=end_date)\n    data.to_csv('./sp500_daily.csv')\n    return data\n\n\n# clean column names\ndef clean_cols(name) -&gt; str:\n    return name.lower().replace(\" \", \"_\").replace(\"%\",\"\")\n\n\n# get quote data from Yahoo\ndf_yahoo = get_quotes(sp500_tickers)\ndf_yahoo.head()\n\n\n\n\n\n\n\n\nAdj Close\n...\nVolume\n\n\n\nA\nAAL\nAAPL\nABBV\nABNB\nABT\nACGL\nACN\nADBE\nADI\n...\nWYNN\nXEL\nXOM\nXRAY\nXYL\nYUM\nZBH\nZBRA\nZION\nZTS\n\n\nDate\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2020-09-28 00:00:00\n97.644173\n12.76\n112.918945\n76.775093\nNaN\n99.386688\n29.260000\n213.752274\n488.510010\n110.920738\n...\n3203500\n2062300\n23396500\n1289000\n806800\n1694600\n937197\n272700\n1478700\n2293800\n\n\n2020-09-29 00:00:00\n98.340843\n12.25\n112.064384\n76.432030\nNaN\n100.100395\n28.870001\n214.999588\n489.329987\n110.532234\n...\n4250900\n2066200\n20770500\n1042800\n885600\n1612600\n856445\n190500\n1437200\n1046300\n\n\n2020-09-30 00:00:00\n99.047356\n12.29\n113.753853\n77.047775\nNaN\n103.564285\n29.250000\n216.832184\n490.429993\n110.617508\n...\n4450800\n3208500\n22223700\n1159900\n879900\n1735200\n1040300\n596400\n1911600\n1906700\n\n\n2020-10-01 00:00:00\n99.322098\n12.58\n114.716461\n76.651939\nNaN\n103.383469\n29.400000\n216.054993\n499.510010\n112.749519\n...\n4258900\n2240200\n36890200\n671400\n699000\n1300700\n1134957\n461200\n1515200\n1061900\n\n\n2020-10-02 00:00:00\n98.134804\n13.00\n111.013382\n75.754715\nNaN\n101.347023\n29.700001\n213.387650\n478.989990\n108.030701\n...\n3115800\n2265300\n32694300\n654200\n611400\n2173300\n1000748\n354500\n3176100\n1042600\n\n\n\n\n5 rows × 3018 columns\n\n\n\n\n# flatten data and compute intraday and daily return for each ticker\ndf_yahoo_return = (\n    df_yahoo\n    .stack(level=1)\n    .reset_index()\n    .rename(columns={'level_1': 'symbol'})\n    .rename(columns=clean_cols)\n    .sort_values(by=['symbol', 'date'])\n    .reset_index(drop=True)\n    .groupby('symbol')\n    .apply(lambda df_: df_.assign(intraday_return=(df_.close - df_.open)/df_.open,\n                                  daily_return=df_.adj_close.pct_change()))\n    .reset_index(drop=True)\n    .assign(date=lambda df_: pd.to_datetime(df_.date))\n    .round(2)\n)\ndf_yahoo_return.head()\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n0\n2020-09-28\nA\n97.64\n99.51\n99.73\n98.12\n98.64\n1336600.0\n0.01\nNaN\n\n\n1\n2020-09-29\nA\n98.34\n100.22\n101.33\n99.59\n99.79\n722400.0\n0.00\n0.01\n\n\n2\n2020-09-30\nA\n99.05\n100.94\n101.89\n100.31\n100.54\n1362200.0\n0.00\n0.01\n\n\n3\n2020-10-01\nA\n99.32\n101.22\n102.41\n100.54\n101.77\n723600.0\n-0.01\n0.00\n\n\n4\n2020-10-02\nA\n98.13\n100.01\n101.28\n99.81\n100.21\n712200.0\n-0.00\n-0.01\n\n\n\n\n\n\n\n\n# Get top 20 highest and lowest intraday movers\nyahoo_top_20_intraday = df_yahoo_return.nlargest(20, 'intraday_return')\nyahoo_bottom_20_intraday = df_yahoo_return.nsmallest(20, 'intraday_return')\n\n# Get top 20 highest and lowest daily returns\nyahoo_top_20_daily = df_yahoo_return.nlargest(20, 'daily_return')\nyahoo_bottom_20_daily = df_yahoo_return.nsmallest(20, 'daily_return')\n\n\nyahoo_top_20_daily\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n45969\n2020-11-04\nBIIB\n355.63\n355.63\n363.92\n251.75\n253.20\n14591500.0\n0.40\n0.44\n\n\n46446\n2022-09-28\nBIIB\n276.61\n276.61\n283.44\n265.02\n282.96\n16232000.0\n-0.02\n0.40\n\n\n62560\n2020-11-09\nCCL\n19.25\n19.25\n19.86\n17.71\n18.49\n185304300.0\n0.04\n0.39\n\n\n46115\n2021-06-07\nBIIB\n395.85\n395.85\n468.55\n286.00\n295.35\n17954100.0\n0.34\n0.38\n\n\n16554\n2020-10-22\nALGN\n453.23\n453.23\n459.00\n424.00\n424.32\n5114700.0\n0.07\n0.35\n\n\n292337\n2020-11-09\nREG\n40.68\n45.96\n47.22\n37.63\n38.00\n5281200.0\n0.21\n0.35\n\n\n145170\n2020-11-09\nFRT\n80.93\n91.61\n94.32\n75.12\n75.60\n2783100.0\n0.21\n0.33\n\n\n198145\n2020-11-09\nKIM\n12.08\n13.57\n13.96\n11.72\n11.74\n19590900.0\n0.16\n0.32\n\n\n133860\n2020-11-09\nFANG\n28.45\n32.40\n33.60\n28.01\n28.25\n10946900.0\n0.15\n0.31\n\n\n140397\n2022-11-10\nFICO\n581.78\n581.78\n581.87\n518.26\n525.74\n844600.0\n0.11\n0.31\n\n\n349641\n2020-11-09\nVLO\n43.88\n50.08\n50.91\n44.90\n44.91\n19211600.0\n0.12\n0.31\n\n\n171755\n2020-11-09\nHST\n12.98\n13.64\n14.98\n12.76\n13.00\n29635500.0\n0.05\n0.30\n\n\n291583\n2020-11-09\nRCL\n75.43\n75.43\n78.86\n71.24\n73.27\n27736800.0\n0.03\n0.29\n\n\n311187\n2020-11-09\nSPG\n66.90\n79.10\n82.50\n73.10\n74.87\n24996200.0\n0.06\n0.28\n\n\n368491\n2020-11-09\nWYNN\n101.74\n102.24\n105.93\n95.00\n95.17\n18916800.0\n0.07\n0.28\n\n\n17127\n2023-02-02\nALGN\n359.88\n359.88\n368.87\n332.60\n336.50\n4437200.0\n0.07\n0.27\n\n\n243485\n2020-11-09\nNCLH\n21.51\n21.51\n23.05\n20.36\n21.02\n75069900.0\n0.02\n0.27\n\n\n33453\n2022-01-18\nATVI\n80.95\n82.31\n86.90\n81.45\n86.77\n120192800.0\n-0.05\n0.26\n\n\n146554\n2023-05-12\nFSLR\n231.69\n231.69\n232.00\n203.40\n203.80\n23871100.0\n0.14\n0.26\n\n\n42712\n2022-11-17\nBBWI\n38.36\n38.97\n39.51\n35.51\n38.12\n22430000.0\n0.02\n0.25"
  },
  {
    "objectID": "posts/spikeet/index.html#cloudquant-data-liberator",
    "href": "posts/spikeet/index.html#cloudquant-data-liberator",
    "title": "Spikeet data validation",
    "section": "Cloudquant data liberator",
    "text": "Cloudquant data liberator\n\ndf_liberator = liberator.get_dataframe(liberator.query(symbols = sp500_tickers, \n                                                   back_to = '2020-09-20', \n                                                   name='daily_bars_adjusted'))\n\n\ndf_liberator.head()\n\n\n\n\n\n\n\n\n_seq\n_dsname\nmsg_len\nmsg\nmuts\ntimestamp\nsymbol\nlength\nopen\nopen_primary\n...\nvwap\ndividend_amount\ndividend_ratio\nsplit_ratio\nadjustment_factor\nunadjusted_close\nspread\nbidvol\naskvol\ncount\n\n\n\n\n0\n2444\nadjusted_daily_oc_bar\n74\nb\n1600695000000000\n2020-09-21 09:30:00.000\nA\n23400\n96.145203\n96.145203\n...\n95.606796\n0.0\n1.0\n1.0\n0.979275\n98.129997\n0.059200\n357103\n173750\n12763\n\n\n1\n26875\nadjusted_daily_oc_bar\n74\nb\n1600695000000000\n2020-09-21 09:30:00.000\nAAL\n23400\n12.820000\n12.800000\n...\n12.355127\n0.0\n1.0\n1.0\n1.000000\n12.210000\n0.009493\n20606866\n23739436\n212399\n\n\n2\n49075\nadjusted_daily_oc_bar\n74\nb\n1600695000000000\n2020-09-21 09:30:00.000\nAAPL\n23400\n102.683899\n102.664299\n...\n105.046799\n0.0\n1.0\n1.0\n0.982246\n110.080002\n0.017400\n64653941\n71457320\n1362791\n\n\n3\n84210\nadjusted_daily_oc_bar\n74\nb\n1600695000000000\n2020-09-21 09:30:00.000\nABBV\n23400\n78.411201\n78.508202\n...\n77.593697\n0.0\n1.0\n1.0\n0.879641\n89.089996\n0.014000\n2540122\n2128676\n77606\n\n\n4\n141047\nadjusted_daily_oc_bar\n74\nb\n1600695000000000\n2020-09-21 09:30:00.000\nABT\n23400\n100.680801\n100.633400\n...\n100.401901\n0.0\n1.0\n1.0\n0.951615\n105.949997\n0.029300\n1803448\n1037149\n48282\n\n\n\n\n5 rows × 25 columns\n\n\n\n\ncolumns = ['timestamp','symbol','open','high','low','close','unadjusted_close']\n\n\ndf_liberator_return = (\n df_liberator\n [columns]\n .assign(date=lambda df_: pd.to_datetime(df_.timestamp).dt.date)\n .drop(columns=['timestamp'])\n .reindex(columns=['date', 'symbol', 'open', 'high', 'low', 'close', 'unadjusted_close'])\n .sort_values(by=['symbol', 'date'])\n .reset_index(drop=True)\n .groupby('symbol')\n .apply(lambda df_: df_.assign(intraday_return=(df_.close - df_.open)/df_.open,\n                                daily_return=df_.close.pct_change()))\n .reset_index(drop=True)\n .round(2)\n)\ndf_liberator_return.head()\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n0\n2020-09-21\nA\n96.15\n96.52\n94.50\n96.10\n98.13\n-0.00\nNaN\n\n\n1\n2020-09-22\nA\n95.81\n96.92\n95.47\n96.58\n98.62\n0.01\n0.00\n\n\n2\n2020-09-23\nA\n96.56\n96.86\n94.57\n94.90\n96.91\n-0.02\n-0.02\n\n\n3\n2020-09-24\nA\n94.57\n94.96\n93.46\n94.34\n96.34\n-0.00\n-0.01\n\n\n4\n2020-09-25\nA\n93.97\n96.10\n93.79\n95.67\n97.69\n0.02\n0.01\n\n\n\n\n\n\n\n\n# Get top 20 highest and lowest intraday movers\ncq_top_20_intraday = df_liberator_return.nlargest(20, 'intraday_return')\ncq_bottom_20_intraday = df_liberator_return.nsmallest(20, 'intraday_return')\n\n# Get top 20 highest and lowest daily returns\ncq_top_20_daily = df_liberator_return.nlargest(20, 'daily_return')\ncq_bottom_20_daily = df_liberator_return.nsmallest(20, 'daily_return')"
  },
  {
    "objectID": "posts/spikeet/index.html#spikeet-data",
    "href": "posts/spikeet/index.html#spikeet-data",
    "title": "Spikeet data validation",
    "section": "Spikeet data",
    "text": "Spikeet data\n\n# function to clean daily returns strings and convert to float\ndef clean_daily_returns(df_):\n    return (df_\n            .daily_return\n            .str.replace(\",\",\"\")\n            .astype(float)\n            .div(100)\n            .round(2)\n            )\n\n\nSpikeet daily top 20\n\n# [daily][0][close][adjusted] / [daily][-1][close][adjusted] &gt; 1.2\ndf_skeet_daily_top = pd.read_csv('spikeet_daily_chg_gt_20.csv')\ndf_skeet_daily_top.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-CLOSE%\n\n\n\n\n0\nCRDF\n2020-09-21\n206,217,480.95\n8.90\n11.87\n8.86\n11.60\n27,581.00\n33.18\n\n\n1\nCLSK\n2020-09-21\n200,747,131.20\n11.00\n15.07\n10.73\n14.84\n20,724.00\n28.48\n\n\n2\nCRMD\n2020-09-21\n144,009,918.34\n5.23\n6.06\n4.85\n5.72\n78,941.00\n24.08\n\n\n3\nACST\n2020-09-21\n20,957,855.75\n11.88\n14.35\n11.27\n13.39\n84,294.21\n28.99\n\n\n4\nZOM\n2020-09-21\n39,483,600.66\n0.10\n0.11\n0.10\n0.10\n8,517,670.00\n42.86\n\n\n\n\n\n\n\n\ndf_skeet_daily_top.isna().sum()\n\nSymbol                       4\nDate                         0\nMarket Cap                2130\nOpen Price Today             0\nHigh Price Today             0\nLow Price Today              0\nClose Price Today            0\nPremarket Volume Today    1971\nCHG-CLOSE%                   0\ndtype: int64\n\n\n\n4 symbols are NA in the data returned by Spikeet\n\n\ndf_skeet_daily_top.query('Symbol.isna()')\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-CLOSE%\n\n\n\n\n7899\nNaN\n2022-07-25\nNaN\n7.10\n13.00\n7.01\n10.56\n133.00\n55.52\n\n\n7958\nNaN\n2022-07-29\nNaN\n7.81\n12.49\n7.35\n9.62\n1,101.00\n23.33\n\n\n12693\nNaN\n2023-05-25\nNaN\n2.07\n2.97\n1.87\n2.37\n2,113,598.00\n63.45\n\n\n12867\nNaN\n2023-06-08\nNaN\n2.10\n2.95\n2.10\n2.72\n5,880.00\n25.93\n\n\n\n\n\n\n\n\ncolumns = ['date','symbol','open_price_today','high_price_today','low_price_today','close_price_today','daily_return']\n\n\nskeet_top_20_daily = (\n df_skeet_daily_top\n .rename(columns=clean_cols)\n .rename(columns={'chg-close':'daily_return'})\n .assign(daily_return=lambda df_: clean_daily_returns(df_))\n .query('symbol in @sp500_tickers')\n .nlargest(25, 'daily_return')\n [columns]\n )\nskeet_top_20_daily\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\ndaily_return\n\n\n\n\n481\n2020-11-04\nBIIB\n253.20\n363.92\n251.75\n355.63\n0.44\n\n\n8776\n2022-09-28\nBIIB\n282.96\n283.44\n265.02\n276.61\n0.40\n\n\n535\n2020-11-09\nCCL\n18.49\n19.86\n17.71\n19.25\n0.39\n\n\n3930\n2021-06-07\nBIIB\n295.35\n468.55\n286.00\n395.85\n0.38\n\n\n392\n2020-10-22\nALGN\n424.32\n459.00\n424.00\n453.23\n0.35\n\n\n532\n2020-11-09\nREG\n38.00\n47.22\n37.63\n45.96\n0.35\n\n\n645\n2020-11-09\nFRT\n75.60\n94.32\n75.12\n91.61\n0.33\n\n\n578\n2020-11-09\nKIM\n11.74\n13.96\n11.72\n13.57\n0.32\n\n\n684\n2020-11-09\nVLO\n44.91\n50.91\n44.90\n50.08\n0.31\n\n\n693\n2020-11-09\nFANG\n28.25\n33.60\n28.01\n32.40\n0.31\n\n\n9349\n2022-11-10\nFICO\n525.74\n581.87\n518.26\n581.78\n0.31\n\n\n676\n2020-11-09\nHST\n13.00\n14.98\n12.76\n13.64\n0.30\n\n\n559\n2020-11-09\nRCL\n73.27\n78.86\n71.24\n75.43\n0.29\n\n\n543\n2020-11-09\nWYNN\n95.17\n105.93\n95.00\n102.24\n0.28\n\n\n643\n2020-11-09\nSPG\n74.87\n82.50\n73.10\n79.10\n0.28\n\n\n699\n2020-11-09\nNCLH\n21.02\n23.05\n20.36\n21.51\n0.27\n\n\n10935\n2023-02-02\nALGN\n336.50\n368.87\n332.60\n359.88\n0.27\n\n\n5577\n2022-01-18\nATVI\n86.77\n86.90\n81.45\n82.31\n0.26\n\n\n12481\n2023-05-12\nFSLR\n203.80\n232.00\n203.40\n231.69\n0.26\n\n\n542\n2020-11-09\nEXPE\n119.20\n130.57\n119.19\n128.64\n0.25\n\n\n632\n2020-11-09\nMTB\n110.64\n125.38\n110.64\n123.92\n0.25\n\n\n4945\n2021-10-27\nENPH\n205.50\n225.40\n204.04\n216.22\n0.25\n\n\n6231\n2022-03-16\nEPAM\n233.51\n284.50\n232.30\n281.72\n0.25\n\n\n687\n2020-11-09\nZION\n35.00\n40.90\n34.96\n39.58\n0.24\n\n\n9511\n2022-11-17\nBBWI\n38.12\n39.51\n35.51\n38.97\n0.24\n\n\n\n\n\n\n\n\n\nSpikeet daily bottom 20\n\n# [daily][0][close][adjusted] / [daily][-1][close][adjusted] &lt; 0.8\ndf_skeet_daily_bottom = pd.read_csv('spikeet_daily_chg_lt_80.csv')\ndf_skeet_daily_bottom.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-CLOSE%\nClose Price Yesterday\n\n\n\n\n0\nWVE\n2020-09-21\n712,310,593.34\n19.79\n19.79\n14.68\n15.05\n2,318.00\n-22.98\n19.54\n\n\n1\nACET\n2020-09-21\n111,444,715.80\n17.77\n18.89\n12.92\n13.48\n42,030.00\n-37.01\n21.40\n\n\n2\nICAD\n2020-09-21\n265,646,867.20\n10.50\n10.50\n8.70\n9.26\n18,094.00\n-20.17\n11.60\n\n\n3\nBATL\n2020-09-21\nNaN\n10.91\n10.91\n7.38\n7.61\nNaN\n-29.99\n10.87\n\n\n4\nCDOR\n2020-09-21\n50,201,039.24\n4.15\n4.15\n2.71\n2.95\n500.00\n-29.43\n4.18\n\n\n\n\n\n\n\n\ndf_skeet_daily_bottom.isna().sum()\n\nSymbol                       3\nDate                         0\nMarket Cap                1293\nOpen Price Today             0\nHigh Price Today             0\nLow Price Today              0\nClose Price Today            0\nPremarket Volume Today     883\nCHG-CLOSE%                   0\nClose Price Yesterday        0\ndtype: int64\n\n\n\n3 records with Symbol NA in returned Spikeet data\n\n\ncolumns = ['date','symbol','open_price_today','high_price_today','low_price_today','close_price_today','close_price_yesterday','daily_return']\n\n\nskeet_bottom_20_daily = (\n df_skeet_daily_bottom\n .rename(columns=clean_cols)\n .rename(columns={'chg-close':'daily_return'})\n .assign(daily_return=lambda df_: round(df_.daily_return/100,2))\n .query('symbol in @sp500_tickers')\n # get 25 to account for dup returns\n .nsmallest(25, 'daily_return')\n [columns]\n )\nskeet_bottom_20_daily\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nclose_price_yesterday\ndaily_return\n\n\n\n\n5213\n2023-02-01\nC\n51.54\n52.74\n51.41\n52.15\n261.10\n-0.80\n\n\n2320\n2022-02-28\nEPAM\n351.44\n355.76\n198.25\n207.75\n382.43\n-0.46\n\n\n742\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n0.81\n-0.38\n\n\n2698\n2022-04-20\nNFLX\n245.20\n248.70\n212.51\n226.19\n348.61\n-0.35\n\n\n6910\n2023-08-03\nDXC\n20.70\n21.03\n18.61\n19.10\n27.07\n-0.29\n\n\n4395\n2022-11-03\nFIS\n67.53\n68.36\n56.53\n57.18\n79.47\n-0.28\n\n\n5592\n2023-03-13\nCMA\n42.73\n51.00\n29.17\n42.54\n58.81\n-0.28\n\n\n6201\n2023-05-04\nPARA\n18.91\n19.04\n16.39\n16.40\n22.89\n-0.28\n\n\n4317\n2022-10-28\nDVA\n77.20\n77.50\n69.26\n70.54\n96.75\n-0.27\n\n\n5583\n2023-03-13\nKEY\n12.24\n12.89\n9.61\n11.38\n15.66\n-0.27\n\n\n5957\n2023-04-14\nCTLT\n46.77\n50.70\n45.09\n46.32\n63.31\n-0.27\n\n\n5604\n2023-03-13\nZION\n26.25\n37.25\n22.55\n29.97\n40.35\n-0.26\n\n\n6073\n2023-04-26\nENPH\n178.63\n183.31\n160.61\n163.83\n220.60\n-0.26\n\n\n6224\n2023-05-08\nCTLT\n35.60\n36.75\n34.37\n35.46\n47.75\n-0.26\n\n\n2151\n2022-02-02\nPYPL\n139.89\n139.90\n129.01\n132.57\n175.80\n-0.25\n\n\n3048\n2022-05-18\nTGT\n163.07\n168.00\n155.20\n161.61\n215.28\n-0.25\n\n\n4075\n2022-09-29\nKMX\n73.75\n75.99\n64.44\n65.16\n86.42\n-0.25\n\n\n4237\n2022-10-19\nGNRC\n121.86\n123.05\n109.05\n110.30\n147.74\n-0.25\n\n\n4336\n2022-11-01\nCTLT\n49.27\n53.79\n47.60\n49.53\n65.73\n-0.25\n\n\n6947\n2023-08-04\nFTNT\n60.42\n61.36\n56.10\n56.77\n75.76\n-0.25\n\n\n6890\n2023-08-02\nGNRC\n124.55\n132.95\n114.40\n115.95\n153.38\n-0.24\n\n\n183\n2020-11-03\nSEDG\n213.09\n217.97\n201.56\n206.37\n267.72\n-0.23\n\n\n4088\n2022-09-30\nCCL\n8.45\n8.51\n7.01\n7.03\n9.16\n-0.23\n\n\n2093\n2022-01-21\nNFLX\n400.43\n409.15\n379.99\n397.50\n508.25\n-0.22\n\n\n2119\n2022-01-27\nTER\n110.52\n112.40\n102.51\n111.24\n143.37\n-0.22\n\n\n\n\n\n\n\n\n\nSpikeet intraday top 20\n\ndf_skeet_intra_top = pd.read_csv(\"./spikeet_intra_gt14.csv\")\ndf_skeet_intra_top.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n0\nNOG\n2020-09-21\nNaN\n5.08\n5.90\n4.93\n5.90\n11,389.00\n16.14\n\n\n1\nCLSK\n2020-09-21\n200,747,131.20\n11.00\n15.07\n10.73\n14.84\n20,724.00\n34.91\n\n\n2\nCXDO\n2020-09-21\n114,509,843.99\n6.30\n7.63\n6.30\n7.39\n1,100.00\n17.30\n\n\n3\nSEED\n2020-09-21\n48,513,488.32\n9.09\n10.86\n8.69\n10.70\n442.00\n17.71\n\n\n4\nBGMD\n2020-09-21\nNaN\n0.01\n0.01\n0.01\n0.01\nNaN\n17.89\n\n\n\n\n\n\n\n\ncolumns = ['date','symbol','open_price_today','high_price_today','low_price_today','close_price_today','intra_return']\n\n\nskeet_top_20_intra = (\n df_skeet_intra_top\n .rename(columns=clean_cols)\n .rename(columns={'chg-open':'intra_return'})\n .assign(intra_return=lambda df_ : (df_.intra_return.str.replace(\",\",\"\")\n                                    .astype(float))/100)\n                                    .round(2)\n .query('symbol in @sp500_tickers')\n # get 25 to account for dup returns\n .nlargest(25, 'intra_return')\n [columns]\n )\nskeet_top_20_intra\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n697\n2020-11-04\nBIIB\n253.20\n363.92\n251.75\n355.63\n0.40\n\n\n5544\n2021-06-07\nBIIB\n295.35\n468.55\n286.00\n395.85\n0.34\n\n\n19544\n2023-03-13\nRF\n14.21\n20.11\n13.94\n18.85\n0.33\n\n\n18495\n2023-01-24\nNCLH\n12.35\n18.54\n12.35\n15.43\n0.25\n\n\n9378\n2022-02-24\nENPH\n119.00\n147.93\n118.57\n147.35\n0.24\n\n\n809\n2020-11-09\nFRT\n75.60\n94.32\n75.12\n91.61\n0.21\n\n\n823\n2020-11-09\nREG\n38.00\n47.22\n37.63\n45.96\n0.21\n\n\n8937\n2022-02-24\nSEDG\n223.43\n271.66\n220.03\n271.19\n0.21\n\n\n10068\n2022-03-16\nEPAM\n233.51\n284.50\n232.30\n281.72\n0.21\n\n\n11050\n2022-05-04\nMTCH\n69.53\n85.44\n69.28\n83.88\n0.21\n\n\n1609\n2020-12-09\nCTRA\n10.55\n12.69\n10.55\n12.61\n0.20\n\n\n3476\n2021-02-09\nGEN\n0.95\n1.15\n0.95\n1.14\n0.20\n\n\n4119\n2021-03-09\nGEN\n0.50\n0.74\n0.49\n0.60\n0.20\n\n\n18474\n2023-01-24\nVICI\n28.54\n34.12\n28.49\n33.96\n0.19\n\n\n1539\n2020-12-07\nCTRA\n7.60\n9.10\n7.55\n8.99\n0.18\n\n\n4398\n2021-03-18\nHIG\n57.94\n68.95\n57.70\n68.15\n0.18\n\n\n6242\n2021-08-09\nMRNA\n411.30\n493.76\n409.66\n484.47\n0.18\n\n\n1586\n2020-12-08\nCTRA\n8.99\n11.39\n8.99\n10.55\n0.17\n\n\n9170\n2022-02-24\nCSGP\n51.64\n60.74\n51.44\n60.60\n0.17\n\n\n9360\n2022-02-24\nPODD\n218.00\n260.44\n212.12\n255.37\n0.17\n\n\n18480\n2023-01-24\nMPC\n111.72\n143.28\n111.72\n130.21\n0.17\n\n\n793\n2020-11-09\nKIM\n11.74\n13.96\n11.72\n13.57\n0.16\n\n\n8469\n2022-01-28\nFICO\n426.46\n497.00\n425.72\n493.12\n0.16\n\n\n9168\n2022-02-24\nPANW\n155.69\n180.22\n155.50\n179.98\n0.16\n\n\n9645\n2022-03-04\nOXY\n48.46\n56.45\n48.14\n56.15\n0.16\n\n\n\n\n\n\n\n\n\nSpikeet intra bottom 20\n\ndf_skeet_intra_bottom = pd.read_csv(\"./spikeet_intra_bottom.csv\")\ndf_skeet_intra_bottom.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n0\nLBRT\n2020-09-21\n764,526,989.62\n8.83\n8.83\n7.43\n7.65\n240.00\n-13.36\n\n\n1\nNTN\n2020-09-21\n5,868,139.86\n96.00\n111.60\n73.20\n78.00\n57,602.88\n-18.75\n\n\n2\nACET\n2020-09-21\n111,444,715.80\n17.77\n18.89\n12.92\n13.48\n42,030.00\n-24.14\n\n\n3\nBATL\n2020-09-21\nNaN\n10.91\n10.91\n7.38\n7.61\nNaN\n-30.25\n\n\n4\nPIRS\n2020-09-21\n154,575,870.00\n2.84\n2.86\n2.24\n2.33\n13,559.00\n-17.96\n\n\n\n\n\n\n\n\ndf_skeet_intra_bottom.isna().sum()\n\nSymbol                      14\nDate                         0\nMarket Cap                5625\nOpen Price Today             0\nHigh Price Today             0\nLow Price Today              0\nClose Price Today            0\nPremarket Volume Today    7259\nCHG-OPEN%                    0\ndtype: int64\n\n\n\n14 Symbols NA in Spikeet data\n\n\nskeet_bottom_20_intra = (\n df_skeet_intra_bottom\n .rename(columns=clean_cols)\n .rename(columns={'chg-open':'intra_return'})\n .assign(intra_return=lambda df_: round(df_.intra_return/100,2))\n .query('symbol in @sp500_tickers')\n # get 25 to account for dup returns\n .nsmallest(25, 'intra_return')\n [columns]\n )\nskeet_bottom_20_intra\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n8701\n2022-02-28\nEPAM\n351.44\n355.76\n198.25\n207.75\n-0.41\n\n\n2634\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n-0.31\n\n\n1071\n2020-12-01\nMRNA\n177.66\n178.50\n130.33\n141.01\n-0.21\n\n\n346\n2020-10-14\nGEN\n0.65\n0.65\n0.53\n0.53\n-0.19\n\n\n15812\n2022-09-30\nCCL\n8.45\n8.51\n7.01\n7.03\n-0.17\n\n\n12898\n2022-06-21\nDVA\n90.36\n91.62\n74.97\n76.05\n-0.16\n\n\n714\n2020-11-09\nCTLT\n120.48\n120.48\n99.70\n101.91\n-0.15\n\n\n6371\n2021-11-16\nAXON\n208.84\n209.00\n174.78\n177.79\n-0.15\n\n\n10736\n2022-05-05\nAXON\n116.76\n116.81\n96.32\n99.51\n-0.15\n\n\n16929\n2022-11-03\nFIS\n67.53\n68.36\n56.53\n57.18\n-0.15\n\n\n20190\n2023-01-24\nTGT\n169.82\n169.82\n144.30\n144.32\n-0.15\n\n\n20205\n2023-01-24\nLLY\n354.17\n384.44\n302.14\n302.14\n-0.15\n\n\n20217\n2023-01-24\nVZ\n38.69\n44.72\n32.76\n33.04\n-0.15\n\n\n21827\n2023-03-14\nHBAN\n13.02\n13.28\n10.70\n11.05\n-0.15\n\n\n699\n2020-11-09\nPOOL\n373.17\n376.50\n320.92\n322.30\n-0.14\n\n\n1656\n2021-01-15\nSEDG\n329.56\n330.93\n281.83\n282.26\n-0.14\n\n\n7340\n2021-12-20\nMRNA\n321.31\n321.31\n275.12\n276.38\n-0.14\n\n\n8799\n2022-03-03\nEPAM\n246.96\n252.00\n210.76\n212.98\n-0.14\n\n\n8980\n2022-03-07\nUAL\n36.14\n36.50\n30.86\n31.20\n-0.14\n\n\n10238\n2022-04-21\nENPH\n181.97\n181.97\n154.41\n156.56\n-0.14\n\n\n15807\n2022-09-30\nNCLH\n13.24\n13.34\n11.32\n11.36\n-0.14\n\n\n20203\n2023-01-24\nMRO\n32.54\n32.54\n23.92\n27.85\n-0.14\n\n\n20219\n2023-01-24\nUNP\n235.20\n235.20\n201.00\n203.18\n-0.14\n\n\n439\n2020-10-21\nENPH\n116.90\n118.94\n100.40\n101.53\n-0.13\n\n\n521\n2020-10-27\nBEN\n22.60\n22.60\n19.66\n19.73\n-0.13"
  },
  {
    "objectID": "posts/spikeet/index.html#data-provider-comparison",
    "href": "posts/spikeet/index.html#data-provider-comparison",
    "title": "Spikeet data validation",
    "section": "Data provider comparison",
    "text": "Data provider comparison\n\nYahoo and Cloudquant\n\ndaily top 20\n\ndiff_yahoo_top = yahoo_top_20_daily[~yahoo_top_20_daily['symbol'].isin(cq_top_20_daily['symbol'])]\ndiff_cq_top = cq_top_20_daily[~cq_top_20_daily['symbol'].isin(yahoo_top_20_daily['symbol'])]\n\n\n# symbols in Yahoo top 20 but not in cq top 20\ndiff_yahoo_top\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n\n\n\n\n\n\n# symbols in CQ top 20 but not in Yahoo top 20\ndiff_cq_top\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n\n\n\n\n\nNo difference for top 20 daily between Yahoo and Clouquant\n\n\ndaily bottom 20\n\ndiff_yahoo_bottom = yahoo_bottom_20_daily[~yahoo_bottom_20_daily['symbol'].isin(cq_bottom_20_daily['symbol'])]\ndiff_cq_bottom = cq_bottom_20_daily[~cq_bottom_20_daily['symbol'].isin(yahoo_bottom_20_daily['symbol'])]\n\n\n# symbols in Yahoo but not in Cloudquant\ndiff_yahoo_bottom\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n358029\n2021-03-26\nWBD\n41.9\n41.9\n58.21\n34.6\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n\n\n\n\n\n\n# symbols in Cloudquant but not in Yahoo\ndiff_cq_bottom\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n132881\n2022-02-02\nEXC\n38.76\n40.68\n38.52\n40.46\n42.86\n0.04\n-0.26\n\n\n\n\n\n\n\n\n# Cloudquant\n(df_liberator_return\n .astype({\"date\": str})\n .query('symbol==\"EXC\" and date==\"2022-02-02\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n132881\n2022-02-02\nEXC\n38.76\n40.68\n38.52\n40.46\n42.86\n0.04\n-0.26\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"EXC\" and date==\"2022-02-02\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n130400\n2022-02-02\nEXC\n40.46\n42.86\n43.09\n40.8\n41.06\n29696500.0\n0.04\n0.04\n\n\n\n\n\n\n\nClouquant has wrong open of 38.76 on 2022-02-02 should be 41.06, not 38.76\n\n# 2021-03-26    WBD \n# Cloudquant\n(df_liberator_return\n .astype({\"date\": str})\n .query('symbol==\"WBD\" and date.str.contains(\"2021-03\")')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n\n\n\n\n\n\n# Cloudquant\n(df_liberator_return\n .astype({\"date\": str})\n .query('symbol==\"WBD\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen\nhigh\nlow\nclose\nunadjusted_close\nintraday_return\ndaily_return\n\n\n\n\n362760\n2022-04-04\nWBD\n24.90\n25.98\n23.20\n25.50\n25.50\n0.02\nNaN\n\n\n362761\n2022-04-05\nWBD\n25.75\n26.22\n24.25\n24.41\n24.41\n-0.05\n-0.04\n\n\n362762\n2022-04-06\nWBD\n24.13\n24.25\n23.37\n23.98\n23.98\n-0.01\n-0.02\n\n\n362763\n2022-04-07\nWBD\n24.26\n24.26\n22.53\n23.12\n23.12\n-0.05\n-0.04\n\n\n362764\n2022-04-08\nWBD\n22.58\n24.53\n22.58\n24.47\n24.47\n0.08\n0.06\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n363130\n2023-09-25\nWBD\n11.15\n11.18\n10.62\n10.66\n10.66\n-0.04\n-0.04\n\n\n363131\n2023-09-26\nWBD\n10.57\n10.81\n10.43\n10.69\n10.69\n0.01\n0.00\n\n\n363132\n2023-09-27\nWBD\n10.76\n11.11\n10.76\n11.03\n11.03\n0.03\n0.03\n\n\n363133\n2023-09-28\nWBD\n11.08\n11.10\n10.66\n10.69\n10.69\n-0.04\n-0.03\n\n\n363134\n2023-09-29\nWBD\n10.77\n11.07\n10.77\n10.86\n10.86\n0.01\n0.02\n\n\n\n\n375 rows × 9 columns\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"WBD\" and date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n358029\n2021-03-26\nWBD\n41.9\n41.9\n58.21\n34.6\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n\n\n\n\n\nCloudquant does not have WBD data before April of 2022, maybe name change * 2 differences between Yahoo and Cloudquant for bottom 20 daily, seems to be issues with Cloudquant data.\n\n\nintra top 20\n\n# top intra returns\ndf_skeet_intra_top = pd.read_csv(\"./spikeet_intra_gt14.csv\")\ndf_skeet_intra_top.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n0\nNOG\n2020-09-21\nNaN\n5.08\n5.90\n4.93\n5.90\n11,389.00\n16.14\n\n\n1\nCLSK\n2020-09-21\n200,747,131.20\n11.00\n15.07\n10.73\n14.84\n20,724.00\n34.91\n\n\n2\nCXDO\n2020-09-21\n114,509,843.99\n6.30\n7.63\n6.30\n7.39\n1,100.00\n17.30\n\n\n3\nSEED\n2020-09-21\n48,513,488.32\n9.09\n10.86\n8.69\n10.70\n442.00\n17.71\n\n\n4\nBGMD\n2020-09-21\nNaN\n0.01\n0.01\n0.01\n0.01\nNaN\n17.89\n\n\n\n\n\n\n\n\ndf_skeet_intra_top.isna().sum()\n\nSymbol                      13\nDate                         0\nMarket Cap                4168\nOpen Price Today             0\nHigh Price Today             0\nLow Price Today              0\nClose Price Today            0\nPremarket Volume Today    6345\nCHG-OPEN%                    0\ndtype: int64\n\n\n\n13 Symbol NA in Spikeet returned data\n\n\nskeet_top_20_intra = (\n df_skeet_intra_top\n .rename(columns=clean_cols)\n .rename(columns={'chg-open':'intra_return'})\n .assign(intra_return=lambda df_ : (df_.intra_return.str.replace(\",\",\"\")\n                                    .astype(float))/100)\n                                    .round(2)\n .query('symbol in @sp500_tickers')\n .nlargest(25, 'intra_return')\n [columns]\n )\nskeet_top_20_intra\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n697\n2020-11-04\nBIIB\n253.20\n363.92\n251.75\n355.63\n0.40\n\n\n5544\n2021-06-07\nBIIB\n295.35\n468.55\n286.00\n395.85\n0.34\n\n\n19544\n2023-03-13\nRF\n14.21\n20.11\n13.94\n18.85\n0.33\n\n\n18495\n2023-01-24\nNCLH\n12.35\n18.54\n12.35\n15.43\n0.25\n\n\n9378\n2022-02-24\nENPH\n119.00\n147.93\n118.57\n147.35\n0.24\n\n\n809\n2020-11-09\nFRT\n75.60\n94.32\n75.12\n91.61\n0.21\n\n\n823\n2020-11-09\nREG\n38.00\n47.22\n37.63\n45.96\n0.21\n\n\n8937\n2022-02-24\nSEDG\n223.43\n271.66\n220.03\n271.19\n0.21\n\n\n10068\n2022-03-16\nEPAM\n233.51\n284.50\n232.30\n281.72\n0.21\n\n\n11050\n2022-05-04\nMTCH\n69.53\n85.44\n69.28\n83.88\n0.21\n\n\n1609\n2020-12-09\nCTRA\n10.55\n12.69\n10.55\n12.61\n0.20\n\n\n3476\n2021-02-09\nGEN\n0.95\n1.15\n0.95\n1.14\n0.20\n\n\n4119\n2021-03-09\nGEN\n0.50\n0.74\n0.49\n0.60\n0.20\n\n\n18474\n2023-01-24\nVICI\n28.54\n34.12\n28.49\n33.96\n0.19\n\n\n1539\n2020-12-07\nCTRA\n7.60\n9.10\n7.55\n8.99\n0.18\n\n\n4398\n2021-03-18\nHIG\n57.94\n68.95\n57.70\n68.15\n0.18\n\n\n6242\n2021-08-09\nMRNA\n411.30\n493.76\n409.66\n484.47\n0.18\n\n\n1586\n2020-12-08\nCTRA\n8.99\n11.39\n8.99\n10.55\n0.17\n\n\n9170\n2022-02-24\nCSGP\n51.64\n60.74\n51.44\n60.60\n0.17\n\n\n9360\n2022-02-24\nPODD\n218.00\n260.44\n212.12\n255.37\n0.17\n\n\n18480\n2023-01-24\nMPC\n111.72\n143.28\n111.72\n130.21\n0.17\n\n\n793\n2020-11-09\nKIM\n11.74\n13.96\n11.72\n13.57\n0.16\n\n\n8469\n2022-01-28\nFICO\n426.46\n497.00\n425.72\n493.12\n0.16\n\n\n9168\n2022-02-24\nPANW\n155.69\n180.22\n155.50\n179.98\n0.16\n\n\n9645\n2022-03-04\nOXY\n48.46\n56.45\n48.14\n56.15\n0.16\n\n\n\n\n\n\n\n\n\nintra bottom 20\n\n# bottom intra returns\ndf_skeet_intra_bottom = pd.read_csv(\"./spikeet_intra_bottom.csv\")\ndf_skeet_intra_bottom.head()\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n0\nLBRT\n2020-09-21\n764,526,989.62\n8.83\n8.83\n7.43\n7.65\n240.00\n-13.36\n\n\n1\nNTN\n2020-09-21\n5,868,139.86\n96.00\n111.60\n73.20\n78.00\n57,602.88\n-18.75\n\n\n2\nACET\n2020-09-21\n111,444,715.80\n17.77\n18.89\n12.92\n13.48\n42,030.00\n-24.14\n\n\n3\nBATL\n2020-09-21\nNaN\n10.91\n10.91\n7.38\n7.61\nNaN\n-30.25\n\n\n4\nPIRS\n2020-09-21\n154,575,870.00\n2.84\n2.86\n2.24\n2.33\n13,559.00\n-17.96\n\n\n\n\n\n\n\n\ndf_skeet_intra_bottom.isna().sum()\n\nSymbol                      14\nDate                         0\nMarket Cap                5625\nOpen Price Today             0\nHigh Price Today             0\nLow Price Today              0\nClose Price Today            0\nPremarket Volume Today    7259\nCHG-OPEN%                    0\ndtype: int64\n\n\n\n14 Symbol NA in returned data\n\n\nskeet_bottom_20_intra = (\n df_skeet_intra_bottom\n .rename(columns=clean_cols)\n .rename(columns={'chg-open':'intra_return'})\n .assign(intra_return=lambda df_: round(df_.intra_return/100,2))\n .query('symbol in @sp500_tickers')\n .nsmallest(25, 'intra_return')\n [columns]\n )\nskeet_bottom_20_intra\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n8701\n2022-02-28\nEPAM\n351.44\n355.76\n198.25\n207.75\n-0.41\n\n\n2634\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n-0.31\n\n\n1071\n2020-12-01\nMRNA\n177.66\n178.50\n130.33\n141.01\n-0.21\n\n\n346\n2020-10-14\nGEN\n0.65\n0.65\n0.53\n0.53\n-0.19\n\n\n15812\n2022-09-30\nCCL\n8.45\n8.51\n7.01\n7.03\n-0.17\n\n\n12898\n2022-06-21\nDVA\n90.36\n91.62\n74.97\n76.05\n-0.16\n\n\n714\n2020-11-09\nCTLT\n120.48\n120.48\n99.70\n101.91\n-0.15\n\n\n6371\n2021-11-16\nAXON\n208.84\n209.00\n174.78\n177.79\n-0.15\n\n\n10736\n2022-05-05\nAXON\n116.76\n116.81\n96.32\n99.51\n-0.15\n\n\n16929\n2022-11-03\nFIS\n67.53\n68.36\n56.53\n57.18\n-0.15\n\n\n20190\n2023-01-24\nTGT\n169.82\n169.82\n144.30\n144.32\n-0.15\n\n\n20205\n2023-01-24\nLLY\n354.17\n384.44\n302.14\n302.14\n-0.15\n\n\n20217\n2023-01-24\nVZ\n38.69\n44.72\n32.76\n33.04\n-0.15\n\n\n21827\n2023-03-14\nHBAN\n13.02\n13.28\n10.70\n11.05\n-0.15\n\n\n699\n2020-11-09\nPOOL\n373.17\n376.50\n320.92\n322.30\n-0.14\n\n\n1656\n2021-01-15\nSEDG\n329.56\n330.93\n281.83\n282.26\n-0.14\n\n\n7340\n2021-12-20\nMRNA\n321.31\n321.31\n275.12\n276.38\n-0.14\n\n\n8799\n2022-03-03\nEPAM\n246.96\n252.00\n210.76\n212.98\n-0.14\n\n\n8980\n2022-03-07\nUAL\n36.14\n36.50\n30.86\n31.20\n-0.14\n\n\n10238\n2022-04-21\nENPH\n181.97\n181.97\n154.41\n156.56\n-0.14\n\n\n15807\n2022-09-30\nNCLH\n13.24\n13.34\n11.32\n11.36\n-0.14\n\n\n20203\n2023-01-24\nMRO\n32.54\n32.54\n23.92\n27.85\n-0.14\n\n\n20219\n2023-01-24\nUNP\n235.20\n235.20\n201.00\n203.18\n-0.14\n\n\n439\n2020-10-21\nENPH\n116.90\n118.94\n100.40\n101.53\n-0.13\n\n\n521\n2020-10-27\nBEN\n22.60\n22.60\n19.66\n19.73\n-0.13\n\n\n\n\n\n\n\n\n\n\nSpikeet and Yahoo comparison\n\ndaily top 20\n\ndiff_yahoo_skeet = yahoo_top_20_daily[~yahoo_top_20_daily['symbol'].isin(skeet_top_20_daily['symbol'])]\ndiff_skeet = skeet_top_20_daily[~skeet_top_20_daily['symbol'].isin(yahoo_top_20_daily['symbol'])]\n\n\n# symbols in Yahoo top 20 daily not in Spikeet top 20 daily\ndiff_yahoo_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n\n\n\n\n\n\n# symbols in Spikeet top 20 daily not in Yahoo\ndiff_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\ndaily_return\n\n\n\n\n542\n2020-11-09\nEXPE\n119.20\n130.57\n119.19\n128.64\n0.25\n\n\n632\n2020-11-09\nMTB\n110.64\n125.38\n110.64\n123.92\n0.25\n\n\n4945\n2021-10-27\nENPH\n205.50\n225.40\n204.04\n216.22\n0.25\n\n\n6231\n2022-03-16\nEPAM\n233.51\n284.50\n232.30\n281.72\n0.25\n\n\n687\n2020-11-09\nZION\n35.00\n40.90\n34.96\n39.58\n0.24\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"EXPE\" and date==\"2020-11-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n131598\n2020-11-09\nEXPE\n128.64\n128.64\n130.57\n119.19\n119.2\n19306700.0\n0.08\n0.25\n\n\n\n\n\n\n\nEXPE is the same data just multiple 0.25 return in top 20\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"MTB\" and date==\"2020-11-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n240469\n2020-11-09\nMTB\n112.64\n123.92\n125.38\n110.64\n110.64\n3062500.0\n0.12\n0.25\n\n\n\n\n\n\n\nSame, multiple 0.25 daily return in top 20\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"ENPH\" and date==\"2021-10-27\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n120531\n2021-10-27\nENPH\n216.22\n216.22\n225.4\n204.04\n205.5\n15168400.0\n0.05\n0.25\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"EPAM\" and date==\"2022-03-16\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n122135\n2022-03-16\nEPAM\n281.72\n281.72\n284.5\n232.3\n233.51\n3724600.0\n0.21\n0.25\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"ZION\" and date==\"2020-11-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n374523\n2020-11-09\nZION\n35.89\n39.58\n40.9\n34.96\n35.0\n5289500.0\n0.13\n0.24\n\n\n\n\n\n\n\nDaily top 20 same for Spikeet and Yahoo\n\n\ndaily bottom 20\n\ndiff_bottom_yahoo_skeet = yahoo_bottom_20_daily[~yahoo_bottom_20_daily['symbol'].isin(skeet_bottom_20_daily['symbol'])]\ndiff_bottom_skeet = skeet_bottom_20_daily[~skeet_bottom_20_daily['symbol'].isin(yahoo_bottom_20_daily['symbol'])]\n\n\n# symbols in Yahoo daily bottom 20 and not in Spikeet\ndiff_bottom_yahoo_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n45972\n2020-11-09\nBIIB\n236.26\n236.26\n239.50\n223.25\n230.82\n9252600.0\n0.02\n-0.28\n\n\n358029\n2021-03-26\nWBD\n41.90\n41.90\n58.21\n34.60\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n224946\n2022-02-03\nMETA\n237.76\n237.76\n248.00\n235.75\n244.65\n188119900.0\n-0.03\n-0.26\n\n\n\n\n\n\n\n\n# symbols in Spikeet daily bottom 20 and not in Yahoo\ndiff_bottom_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nclose_price_yesterday\ndaily_return\n\n\n\n\n5213\n2023-02-01\nC\n51.54\n52.74\n51.41\n52.15\n261.10\n-0.80\n\n\n742\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n0.81\n-0.38\n\n\n2151\n2022-02-02\nPYPL\n139.89\n139.90\n129.01\n132.57\n175.80\n-0.25\n\n\n3048\n2022-05-18\nTGT\n163.07\n168.00\n155.20\n161.61\n215.28\n-0.25\n\n\n183\n2020-11-03\nSEDG\n213.09\n217.97\n201.56\n206.37\n267.72\n-0.23\n\n\n4088\n2022-09-30\nCCL\n8.45\n8.51\n7.01\n7.03\n9.16\n-0.23\n\n\n2119\n2022-01-27\nTER\n110.52\n112.40\n102.51\n111.24\n143.37\n-0.22\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"BIIB\" and date==\"2020-11-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n45972\n2020-11-09\nBIIB\n236.26\n236.26\n239.5\n223.25\n230.82\n9252600.0\n0.02\n-0.28\n\n\n\n\n\n\n\n\nskeet_bottom_20_daily\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nclose_price_yesterday\ndaily_return\n\n\n\n\n5213\n2023-02-01\nC\n51.54\n52.74\n51.41\n52.15\n261.10\n-0.80\n\n\n2320\n2022-02-28\nEPAM\n351.44\n355.76\n198.25\n207.75\n382.43\n-0.46\n\n\n742\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n0.81\n-0.38\n\n\n2698\n2022-04-20\nNFLX\n245.20\n248.70\n212.51\n226.19\n348.61\n-0.35\n\n\n6910\n2023-08-03\nDXC\n20.70\n21.03\n18.61\n19.10\n27.07\n-0.29\n\n\n4395\n2022-11-03\nFIS\n67.53\n68.36\n56.53\n57.18\n79.47\n-0.28\n\n\n5592\n2023-03-13\nCMA\n42.73\n51.00\n29.17\n42.54\n58.81\n-0.28\n\n\n6201\n2023-05-04\nPARA\n18.91\n19.04\n16.39\n16.40\n22.89\n-0.28\n\n\n4317\n2022-10-28\nDVA\n77.20\n77.50\n69.26\n70.54\n96.75\n-0.27\n\n\n5583\n2023-03-13\nKEY\n12.24\n12.89\n9.61\n11.38\n15.66\n-0.27\n\n\n5957\n2023-04-14\nCTLT\n46.77\n50.70\n45.09\n46.32\n63.31\n-0.27\n\n\n5604\n2023-03-13\nZION\n26.25\n37.25\n22.55\n29.97\n40.35\n-0.26\n\n\n6073\n2023-04-26\nENPH\n178.63\n183.31\n160.61\n163.83\n220.60\n-0.26\n\n\n6224\n2023-05-08\nCTLT\n35.60\n36.75\n34.37\n35.46\n47.75\n-0.26\n\n\n2151\n2022-02-02\nPYPL\n139.89\n139.90\n129.01\n132.57\n175.80\n-0.25\n\n\n3048\n2022-05-18\nTGT\n163.07\n168.00\n155.20\n161.61\n215.28\n-0.25\n\n\n4075\n2022-09-29\nKMX\n73.75\n75.99\n64.44\n65.16\n86.42\n-0.25\n\n\n4237\n2022-10-19\nGNRC\n121.86\n123.05\n109.05\n110.30\n147.74\n-0.25\n\n\n4336\n2022-11-01\nCTLT\n49.27\n53.79\n47.60\n49.53\n65.73\n-0.25\n\n\n6947\n2023-08-04\nFTNT\n60.42\n61.36\n56.10\n56.77\n75.76\n-0.25\n\n\n6890\n2023-08-02\nGNRC\n124.55\n132.95\n114.40\n115.95\n153.38\n-0.24\n\n\n183\n2020-11-03\nSEDG\n213.09\n217.97\n201.56\n206.37\n267.72\n-0.23\n\n\n4088\n2022-09-30\nCCL\n8.45\n8.51\n7.01\n7.03\n9.16\n-0.23\n\n\n2093\n2022-01-21\nNFLX\n400.43\n409.15\n379.99\n397.50\n508.25\n-0.22\n\n\n2119\n2022-01-27\nTER\n110.52\n112.40\n102.51\n111.24\n143.37\n-0.22\n\n\n\n\n\n\n\nSpikeet missed BIIB on 2020-11-09 down 28% validated on tradingview\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"WBD\" and date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n358029\n2021-03-26\nWBD\n41.9\n41.9\n58.21\n34.6\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n\n\n\n\n\nSpikeet missed WDB on 2021-03-26 -27% validated on tradingview\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"META\" and date==\"2022-02-03\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n224946\n2022-02-03\nMETA\n237.76\n237.76\n248.0\n235.75\n244.65\n188119900.0\n-0.03\n-0.26\n\n\n\n\n\n\n\nMissed META -26% on 2022-02-03\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"C\" and date==\"2023-02-01\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n56334\n2023-02-01\nC\n50.49\n52.15\n52.74\n51.41\n51.54\n22111900.0\n0.01\n-0.0\n\n\n\n\n\n\n\n\n(df_skeet_daily_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"C\" and Date==\"2023-02-01\"')\n \n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-CLOSE%\nClose Price Yesterday\n\n\n\n\n5213\nC\n2023-02-01\nNaN\n51.54\n52.74\n51.41\n52.15\n51,447.00\n-80.03\n261.10\n\n\n\n\n\n\n\n\nSpikeet has previous day close for C at 261.10, actual close for 2023-01-31 is 52.22\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"GEN\" and date==\"2021-03-03\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n149966\n2021-03-03\nGEN\n18.93\n19.99\n20.11\n19.7\n19.84\n5990000.0\n0.01\n0.0\n\n\n\n\n\n\n\n\n(df_skeet_daily_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"GEN\" and Date==\"2021-03-03\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-CLOSE%\nClose Price Yesterday\n\n\n\n\n742\nGEN\n2021-03-03\n89,720,095.69\n0.73\n0.77\n0.45\n0.50\n735,336.00\n-38.09\n0.81\n\n\n\n\n\n\n\n\nNot sure where Spikeet gets its GEN quotes, wrong ticker ?\n\n\n\nintra top 20\n\ndiff_intra_yahoo_skeet = yahoo_top_20_intraday[~yahoo_top_20_intraday['symbol'].isin(skeet_top_20_intra['symbol'])]\ndiff_intra_skeet = skeet_top_20_intra[~skeet_top_20_intra['symbol'].isin(yahoo_top_20_intraday['symbol'])]\n\n\n# symbol in Yahoo not in Spikeet data\ndiff_intra_yahoo_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n292083\n2022-11-03\nRCL\n53.77\n53.77\n54.20\n45.80\n46.16\n14431800.0\n0.16\n0.08\n\n\n42527\n2022-02-24\nBBWI\n51.46\n53.14\n53.68\n45.88\n46.12\n10078000.0\n0.15\n0.06\n\n\n110875\n2022-05-26\nDXC\n34.16\n34.16\n34.28\n29.51\n29.65\n5632700.0\n0.15\n0.16\n\n\n\n\n\n\n\n\n# symbol in Spikeet not in Yahoo data\ndiff_intra_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n18495\n2023-01-24\nNCLH\n12.35\n18.54\n12.35\n15.43\n0.25\n\n\n1609\n2020-12-09\nCTRA\n10.55\n12.69\n10.55\n12.61\n0.20\n\n\n3476\n2021-02-09\nGEN\n0.95\n1.15\n0.95\n1.14\n0.20\n\n\n4119\n2021-03-09\nGEN\n0.50\n0.74\n0.49\n0.60\n0.20\n\n\n18474\n2023-01-24\nVICI\n28.54\n34.12\n28.49\n33.96\n0.19\n\n\n1539\n2020-12-07\nCTRA\n7.60\n9.10\n7.55\n8.99\n0.18\n\n\n1586\n2020-12-08\nCTRA\n8.99\n11.39\n8.99\n10.55\n0.17\n\n\n18480\n2023-01-24\nMPC\n111.72\n143.28\n111.72\n130.21\n0.17\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"RCL\" and date==\"2022-11-03\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n292083\n2022-11-03\nRCL\n53.77\n53.77\n54.2\n45.8\n46.16\n14431800.0\n0.16\n0.08\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"RCL\" and Date==\"2022-11-03\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n15713\nRCL\n2022-11-03\n12,672,338,864.90\n46.16\n54.20\n45.80\n53.77\n309,843.00\n16.49\n\n\n\n\n\n\n\n\nno issue, multiple entries at 16%\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"BBWI\" and date==\"2022-02-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n42527\n2022-02-24\nBBWI\n51.46\n53.14\n53.68\n45.88\n46.12\n10078000.0\n0.15\n0.06\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"BBWI\" and Date==\"2022-02-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n9384\nBBWI\n2022-02-24\n13,825,349,552.00\n46.12\n53.68\n45.88\n53.14\n4,487.00\n15.22\n\n\n\n\n\n\n\n\nno issue, multiple entries at 15%\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"DXC\" and date==\"2022-05-26\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n110875\n2022-05-26\nDXC\n34.16\n34.16\n34.28\n29.51\n29.65\n5632700.0\n0.15\n0.16\n\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"DXC\" and Date==\"2022-05-26\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n11770\nDXC\n2022-05-26\n7,472,989,125.85\n29.65\n34.27\n29.51\n34.16\n1,199.00\n15.21\n\n\n\n\n\n\n\n\nno issue\n\n\ndiff_intra_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n18495\n2023-01-24\nNCLH\n12.35\n18.54\n12.35\n15.43\n0.25\n\n\n1609\n2020-12-09\nCTRA\n10.55\n12.69\n10.55\n12.61\n0.20\n\n\n3476\n2021-02-09\nGEN\n0.95\n1.15\n0.95\n1.14\n0.20\n\n\n4119\n2021-03-09\nGEN\n0.50\n0.74\n0.49\n0.60\n0.20\n\n\n18474\n2023-01-24\nVICI\n28.54\n34.12\n28.49\n33.96\n0.19\n\n\n1539\n2020-12-07\nCTRA\n7.60\n9.10\n7.55\n8.99\n0.18\n\n\n1586\n2020-12-08\nCTRA\n8.99\n11.39\n8.99\n10.55\n0.17\n\n\n18480\n2023-01-24\nMPC\n111.72\n143.28\n111.72\n130.21\n0.17\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"NCLH\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n244039\n2023-01-24\nNCLH\n15.43\n15.43\n15.9\n14.95\n15.68\n11905900.0\n-0.02\n-0.01\n\n\n\n\n\n\n\n\nYahoo has wrong open for NCLH Spikeet is correct with 25% intra return\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"CTRA\" and date==\"2020-12-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n90903\n2020-12-09\nCTRA\n13.95\n16.77\n16.91\n16.39\n16.56\n6461800.0\n0.01\n0.02\n\n\n\n\n\n\n\n\ndiff_intra_skeet.iloc[1].to_frame()\n\n\n\n\n\n\n\n\n1609\n\n\n\n\ndate\n2020-12-09\n\n\nsymbol\nCTRA\n\n\nopen_price_today\n10.55\n\n\nhigh_price_today\n12.69\n\n\nlow_price_today\n10.55\n\n\nclose_price_today\n12.61\n\n\nintra_return\n0.2\n\n\n\n\n\n\n\n\nSpikeet has wrong quotes for CTRA 2020-12-09\n\n\n (df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"CTRA\" and Date==\"2020-12-09\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n1609\nCTRA\n2020-12-09\n193,158,240.90\n10.55\n12.69\n10.55\n12.61\nNaN\n19.53\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"GEN\" and date==\"2021-02-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n149951\n2021-02-09\nGEN\n20.75\n22.04\n22.06\n20.48\n20.58\n8233100.0\n0.07\n0.07\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"GEN\" and Date==\"2021-02-09\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n3476\nGEN\n2021-02-09\n104,004,057.16\n0.95\n1.15\n0.95\n1.14\n361,119.00\n19.69\n\n\n\n\n\n\n\n\nSpikeet GEN quote for 2021-02-09 are wrong\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"GEN\" and date==\"2021-03-09\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n149970\n2021-03-09\nGEN\n20.39\n21.53\n21.83\n20.98\n21.08\n6189900.0\n0.02\n0.03\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"GEN\" and Date==\"2021-03-09\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n4119\nGEN\n2021-03-09\n55,520,463.71\n0.50\n0.74\n0.49\n0.60\n226,137.00\n19.82\n\n\n\n\n\n\n\n\nGEN quotes wrong in Spikeet\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"VICI\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n349441\n2023-01-24\nVICI\n32.69\n33.96\n34.12\n32.44\n32.45\n3698700.0\n0.05\n0.01\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"VICI\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n18474\nVICI\n2023-01-24\n982,678,627.68\n28.54\n34.12\n28.49\n33.96\n2,725.00\n18.99\n\n\n\n\n\n\n\n\nYahoo quotes validated for VICI 2023-01-24, Spikeet quotes wrong.\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"CTRA\" and date==\"2020-12-07\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n90901\n2020-12-07\nCTRA\n13.75\n16.53\n16.55\n16.06\n16.08\n8927900.0\n0.03\n0.01\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"CTRA\" and Date==\"2020-12-07\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n1539\nCTRA\n2020-12-07\n139,147,168.80\n7.60\n9.10\n7.55\n8.99\nNaN\n18.29\n\n\n\n\n\n\n\n\nSpikeet quotes for CTRA 2020-12-07 are wrong, intraday chg-open is wrong\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"CTRA\" and date==\"2020-12-08\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n90902\n2020-12-08\nCTRA\n13.65\n16.42\n16.73\n16.1\n16.26\n6743400.0\n0.01\n-0.01\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"CTRA\" and Date==\"2020-12-08\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n1586\nCTRA\n2020-12-08\n164,596,453.62\n8.99\n11.39\n8.99\n10.55\n100.00\n17.35\n\n\n\n\n\n\n\n\nSpikeet data for CTRA 2020-12-08 is wrong\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"MPC\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n234237\n2023-01-24\nMPC\n127.92\n130.21\n130.74\n124.2\n124.2\n3782200.0\n0.05\n0.03\n\n\n\n\n\n\n\n\n(df_skeet_intra_top\n .astype({\"Date\": str})\n .query('Symbol==\"MPC\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n18480\nMPC\n2023-01-24\n59,463,686,491.04\n111.72\n143.28\n111.72\n130.21\n3,780.00\n16.55\n\n\n\n\n\n\n\n\nSpikeet open is wrong for MPC 2023-01-24\n\n\n\nintra bottom 20\n\ndiff_intra_bottom_yahoo_skeet = yahoo_bottom_20_intraday[~yahoo_bottom_20_intraday['symbol'].isin(skeet_bottom_20_intra['symbol'])]\ndiff_intra_bottom_skeet = skeet_bottom_20_intra[~skeet_bottom_20_intra['symbol'].isin(yahoo_bottom_20_intraday['symbol'])]\n\n\n# symbol in Yahoo but not in Spikeet\ndiff_intra_bottom_yahoo_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n266795\n2021-03-26\nPARA\n44.60\n48.23\n66.27\n39.81\n65.75\n216631000.0\n-0.27\n-0.27\n\n\n358029\n2021-03-26\nWBD\n41.90\n41.90\n58.21\n34.60\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n354492\n2022-02-28\nVTRS\n10.29\n11.01\n13.74\n10.88\n13.72\n62957100.0\n-0.20\n-0.24\n\n\n266793\n2021-03-24\nPARA\n64.83\n70.10\n85.00\n70.00\n84.40\n89815300.0\n-0.17\n-0.23\n\n\n\n\n\n\n\n\n# symbol in Spikeet but not in Yahoo\ndiff_intra_bottom_skeet\n\n\n\n\n\n\n\n\ndate\nsymbol\nopen_price_today\nhigh_price_today\nlow_price_today\nclose_price_today\nintra_return\n\n\n\n\n2634\n2021-03-03\nGEN\n0.73\n0.77\n0.45\n0.50\n-0.31\n\n\n346\n2020-10-14\nGEN\n0.65\n0.65\n0.53\n0.53\n-0.19\n\n\n20190\n2023-01-24\nTGT\n169.82\n169.82\n144.30\n144.32\n-0.15\n\n\n20205\n2023-01-24\nLLY\n354.17\n384.44\n302.14\n302.14\n-0.15\n\n\n20217\n2023-01-24\nVZ\n38.69\n44.72\n32.76\n33.04\n-0.15\n\n\n20203\n2023-01-24\nMRO\n32.54\n32.54\n23.92\n27.85\n-0.14\n\n\n20219\n2023-01-24\nUNP\n235.20\n235.20\n201.00\n203.18\n-0.14\n\n\n521\n2020-10-27\nBEN\n22.60\n22.60\n19.66\n19.73\n-0.13\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"PARA\" and date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n266795\n2021-03-26\nPARA\n44.6\n48.23\n66.27\n39.81\n65.75\n216631000.0\n-0.27\n-0.27\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"PARA\" and Date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n\n\n\n\n\n\nYahoo quotes validated intra day return of -27% missed by Spikeet\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"WBD\" and date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n358029\n2021-03-26\nWBD\n41.9\n41.9\n58.21\n34.6\n57.45\n106071700.0\n-0.27\n-0.27\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"WBD\" and Date==\"2021-03-26\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n\n\n\n\n\n\nYahoo quotes for WBD 2021-03-26 validated, Spikeet quotes wrong and large intra loser missed\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"VTRS\" and date==\"2022-02-28\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n354492\n2022-02-28\nVTRS\n10.29\n11.01\n13.74\n10.88\n13.72\n62957100.0\n-0.2\n-0.24\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"VTRS\" and Date==\"2022-02-28\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n\n\n\n\n\n\nYahoo quotes validated, Spikeet quotes and chg-open are wrong\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"PARA\" and date==\"2021-03-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n266793\n2021-03-24\nPARA\n64.83\n70.1\n85.0\n70.0\n84.4\n89815300.0\n-0.17\n-0.23\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"PARA\" and Date==\"2021-03-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n\n\n\n\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"GEN\" and date==\"2021-03-03\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n149966\n2021-03-03\nGEN\n18.93\n19.99\n20.11\n19.7\n19.84\n5990000.0\n0.01\n0.0\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"GEN\" and Date==\"2021-03-03\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n2634\nGEN\n2021-03-03\n89,720,095.69\n0.73\n0.77\n0.45\n0.50\n735,336.00\n-31.23\n\n\n\n\n\n\n\n\nHere Spikeet flag GEN for an intraday loss of -31.23% with the wrong quotes. Wrong ticker ?\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"GEN\" and date==\"2020-10-14\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n149871\n2020-10-14\nGEN\n20.17\n21.57\n21.66\n21.25\n21.38\n3479300.0\n0.01\n0.01\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"GEN\" and Date==\"2020-10-14\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n346\nGEN\n2020-10-14\n57,780,244.50\n0.65\n0.65\n0.53\n0.53\n3,765,455.00\n-19.05\n\n\n\n\n\n\n\n\nSpikeet wrong again on GEN, wrong ticker ?\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"TGT\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n328329\n2023-01-24\nTGT\n160.07\n163.55\n169.82\n163.26\n169.82\n1902000.0\n-0.04\n-0.01\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"TGT\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n20190\nTGT\n2023-01-24\n75,780,849,787.44\n169.82\n169.82\n144.30\n144.32\n9,455.00\n-15.02\n\n\n\n\n\n\n\n\nSpikeet wrong close and chg-open for TGT\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"LLY\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n209355\n2023-01-24\nLLY\n343.64\n346.39\n346.63\n341.36\n346.0\n2242500.0\n0.0\n0.01\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"LLY\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n20205\nLLY\n2023-01-24\n325,160,379,159.00\n354.17\n384.44\n302.14\n302.14\n1,757.00\n-14.69\n\n\n\n\n\n\n\n\nSpikeet wrong quotes for LLY on 2023-01-24, seems to be numerous issues with Spikeet data for 2023-01-24\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"VZ\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n355473\n2023-01-24\nVZ\n39.06\n40.42\n40.73\n38.41\n38.69\n32143900.0\n0.04\n0.02\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"VZ\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n20217\nVZ\n2023-01-24\n166,359,751,725.06\n38.69\n44.72\n32.76\n33.04\n1,334,647.00\n-14.6\n\n\n\n\n\n\n\n\nVZ Spikeet quotes wrong for close and chg-open\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"MRO\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n237253\n2023-01-24\nMRO\n27.52\n27.85\n29.85\n27.25\n29.85\n8649500.0\n-0.07\n-0.01\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"MRO\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n20203\nMRO\n2023-01-24\n17,791,527,335.90\n32.54\n32.54\n23.92\n27.85\n62,573.00\n-14.41\n\n\n\n\n\n\n\n\nWrong Spikeet quotes for MRO\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"UNP\" and date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n344917\n2023-01-24\nUNP\n199.29\n203.18\n207.0\n201.0\n205.0\n4462600.0\n-0.01\n-0.03\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"UNP\" and Date==\"2023-01-24\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n20219\nUNP\n2023-01-24\n128,682,208,541.73\n235.20\n235.20\n201.00\n203.18\n11,019.00\n-13.61\n\n\n\n\n\n\n\n\nwrong Spikeet quotes for UNP\n\n\n# Yahoo\n(df_yahoo_return\n .query('symbol==\"BEN\" and date==\"2020-10-27\"')\n )\n\n\n\n\n\n\n\n\ndate\nsymbol\nadj_close\nclose\nhigh\nlow\nopen\nvolume\nintraday_return\ndaily_return\n\n\n\n\n44455\n2020-10-27\nBEN\n17.57\n19.73\n22.6\n19.66\n22.6\n11141900.0\n-0.13\n-0.14\n\n\n\n\n\n\n\n\n# Spikeet\n(df_skeet_intra_bottom\n .astype({\"Date\": str})\n .query('Symbol==\"BEN\" and Date==\"2020-10-27\"')\n )\n\n\n\n\n\n\n\n\nSymbol\nDate\nMarket Cap\nOpen Price Today\nHigh Price Today\nLow Price Today\nClose Price Today\nPremarket Volume Today\nCHG-OPEN%\n\n\n\n\n521\nBEN\n2020-10-27\n11,311,049,225.84\n22.60\n22.60\n19.66\n19.73\n286.00\n-12.7\n\n\n\n\n\n\n\n\nBEN is fine, multiple stocks with -13% intra return"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "data analysis",
    "section": "",
    "text": "Spikeet data validation\n\n\n\n\n\n\n\nquant\n\n\ndata\n\n\nai\n\n\nscanner\n\n\n\n\n\n\n\n\n\n\n\nOct 3, 2023\n\n\nSylvain Thibault\n\n\n\n\n\n\nNo matching items"
  }
]